<div class="row content align-center dashboard" ng-controller="EnvironmentsController as environments"
	  ng-init="environments.initOverview(); " data-equalizer>
	<div class="column no-padding " ng-repeat="environment in environments.overview">
		<div class="environment with-shadow has-controls">

			<div class="content-holder" data-equalizer-watch>
				<h4 class="text-center">{{environment.name}}</h4>

				<div class="row tests text-center">
					<a ng-repeat="result in dashboardTests | filter: {environmentsId: environment.id} | orderBy:'updatedAt'"
						ui-sref="test_result({testResultId: result.id})"
						title="{{result.testName}}, {{result.updatedAt | date : 'short'}}" ng-switch="result.status">

						<span ng-switch-when="success" class="badge success fi-check"></span>
						<span ng-switch-when="failed" class="badge alert fi-x"></span>
						<span ng-switch-when="waiting_for_response" class="badge primary fi-clock"></span>
						<span ng-switch-default="evaluating" class="badge warning fi-eye"></span>
					</a>
				</div>

				<div class="row small">
					<div class="column">
						<i class="fi-arrow-left"></i> Older
					</div>
					<div class="column text-right">
						Recent <i class="fi-arrow-right"></i>
					</div>
				</div>

				<div ng-show="failedDasboardTests[environment.id].length>0">
					<h5>Last failed tests</h5>
					<div class="failed-tests">
						<div class="row align-center">

							<div class="column text-center test" ng-repeat="result in failedDasboardTests[environment.id]">
								<a ui-sref="test_result({testResultId: result.id})"><i class="fi-x badge alert"></i><br />
									{{result.testName}}</a>
								<br />
								<small>{{result.updatedAt | date : 'short'}}</small>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row controls align-right">
				<a ui-sref="tests({environmentId: environment.id})" class="primary button has-tip tiny" data-tooltip
					aria-haspopup="true"
					data-disable-hover="false"
					title="Tests overview"><i class="fi-list"></i> All tests</a>

				&nbsp;

				<a ui-sref="environment_settings({environmentId: environment.id})" data-tooltip aria-haspopup="true"
					class="warning button has-tip tiny"
					data-disable-hover="false"
					title="Environment settings"><i class="fi-wrench"></i> Environment settings</a>
			</div>
		</div>

		<script ng-if="$last && $index > 0">Foundation.reInit ('equalizer')</script>
	</div>


	<a data-open="new-environment" id="add-project" class="button success material-add-button"><i
			  class="fi-plus"></i></a>

	<div class="reveal" id="new-environment" data-reveal>

		<h3>Add environment</h3>

		<form ng-submit="environments.create()">
			<label>
				Name

				<input type="text" placeholder="Environment name" ng-model="environments.formData.name" />
			</label>

			<label>
				API endpoint

				<input type="text" placeholder="https://api.example.com/api/v1"
						 ng-model="environments.formData.apiEndpoint" />
			</label>


			<label>
				Description

			<textarea rows="2" name="description" ng-model="environments.formData.description"
						 placeholder="Some brief description of this API environment"></textarea>
			</label>

			<button type="submit" class="button success float-right">Create new</button>
		</form>

		<!-- Close button -->
		<button class="close-button" data-close aria-label="Close modal" type="button">
			<span aria-hidden="true">&times;</span>
		</button>
	</div>


</div>